{"version":3,"file":"show-shader-errors.js","sources":["../../src/scripts/show-shader-errors.js"],"sourcesContent":["if (typeof GPUDevice !== 'undefined') {\n  console.log('webgpu-dev-extension: show-shader-errors');\n\n  const showError = async function (module, code, stack) {\n    const info = await module.getCompilationInfo();\n    const lines = code.split('\\n');\n    const messages = [...info.messages];\n    messages.sort((a, b) => {\n      const dl = b.lineNum - a.lineNum;\n      if (dl) {\n        return dl;\n      }\n      return b.linePos - a.linePos;\n    });\n    for (const {type, message, lineNum, linePos, length} of messages) {\n      lines.splice(\n        lineNum,\n        0,\n        `${''.padStart(linePos)}${''.padStart(length, 'â‰ˆ')} <======`,\n        `${type}: ${message}`,\n      );\n    }\n    console.error(stack);\n    console.error(lines.join('\\n'));\n  };\n\n  GPUDevice.prototype.createShaderModule = (function (origFn) {\n    return function (desc = {}) {\n      const code = desc.code;\n      const stack = new Error();\n      this.pushErrorScope('validation');\n      const module = origFn.call(this, desc);\n      this.popErrorScope().then(err => {\n        if (err) {\n          showError(module, code, stack);\n        }\n      });\n      return module;\n    };\n  })(GPUDevice.prototype.createShaderModule);\n}\n\ndocument.currentScript?.remove();\n"],"names":[],"mappings":";;;;EAAA,IAAI,OAAO,SAAS,KAAK,WAAW,EAAE;EACtC,EAAE,OAAO,CAAC,GAAG,CAAC,0CAA0C,CAAC;;EAEzD,EAAE,MAAM,SAAS,GAAG,gBAAgB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE;EACzD,IAAI,MAAM,IAAI,GAAG,MAAM,MAAM,CAAC,kBAAkB,EAAE;EAClD,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;EAClC,IAAI,MAAM,QAAQ,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;EACvC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK;EAC5B,MAAM,MAAM,EAAE,GAAG,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,OAAO;EACtC,MAAM,IAAI,EAAE,EAAE;EACd,QAAQ,OAAO,EAAE;EACjB;EACA,MAAM,OAAO,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,OAAO;EAClC,KAAK,CAAC;EACN,IAAI,KAAK,MAAM,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,IAAI,QAAQ,EAAE;EACtE,MAAM,KAAK,CAAC,MAAM;EAClB,QAAQ,OAAO;EACf,QAAQ,CAAC;EACT,QAAQ,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,QAAQ,CAAC;EACpE,QAAQ,CAAC,EAAE,IAAI,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;EAC7B,OAAO;EACP;EACA,IAAI,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC;EACxB,IAAI,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACnC,GAAG;;EAEH,EAAE,SAAS,CAAC,SAAS,CAAC,kBAAkB,GAAG,CAAC,UAAU,MAAM,EAAE;EAC9D,IAAI,OAAO,UAAU,IAAI,GAAG,EAAE,EAAE;EAChC,MAAM,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI;EAC5B,MAAM,MAAM,KAAK,GAAG,IAAI,KAAK,EAAE;EAC/B,MAAM,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC;EACvC,MAAM,MAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC;EAC5C,MAAM,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC,GAAG,IAAI;EACvC,QAAQ,IAAI,GAAG,EAAE;EACjB,UAAU,SAAS,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC;EACxC;EACA,OAAO,CAAC;EACR,MAAM,OAAO,MAAM;EACnB,KAAK;EACL,GAAG,EAAE,SAAS,CAAC,SAAS,CAAC,kBAAkB,CAAC;EAC5C;;EAEA,QAAQ,CAAC,aAAa,EAAE,MAAM,EAAE;;;;;;"}